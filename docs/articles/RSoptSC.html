<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clustering Pseudotime Inference on Skin Cell scRNA-seq • RSoptSC</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Clustering Pseudotime Inference on Skin Cell scRNA-seq">
<meta property="og:description" content="RSoptSC">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RSoptSC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/RSoptSC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mkarikom/RSoptSC/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="RSoptSC_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="RSoptSC_files/kePrint-0.0.1/kePrint.js"></script><link href="RSoptSC_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Clustering Pseudotime Inference on Skin Cell scRNA-seq</h1>
                        <h4 class="author">Matt Karikomi</h4>
            
            <h4 class="date">2020-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mkarikom/RSoptSC/blob/master/vignettes/RSoptSC.Rmd"><code>vignettes/RSoptSC.Rmd</code></a></small>
      <div class="hidden name"><code>RSoptSC.Rmd</code></div>

    </div>

    
    
<p>This is an example of clustering, marker identification and pseudotime inference on a set of skin cells.</p>
<div id="load-and-preprocess-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-and-preprocess-data" class="anchor"></a>Load and Preprocess Data</h2>
<p>A matrix of counts with rows as genes and columns as cells must be provided. Gene and cell ids, and [optionally] a vector of labels e.g. cell types are provided in separate text files. Here we load example data from NCBI GEO (GSE67602) originally published in Joost et al 2016.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GSE67602_JoostData.csv.bz2"</span>, package <span class="op">=</span> <span class="st">"RSoptSC"</span><span class="op">)</span>
<span class="va">gf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GSE67602_JoostGenes.csv.bz2"</span>, package <span class="op">=</span> <span class="st">"RSoptSC"</span><span class="op">)</span>
<span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GSE67602_JoostCells.csv.bz2"</span>, package <span class="op">=</span> <span class="st">"RSoptSC"</span><span class="op">)</span>
<span class="va">af</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GSE67602_JoostAnnotation.csv.bz2"</span>, package <span class="op">=</span> <span class="st">"RSoptSC"</span><span class="op">)</span>

<span class="va">GSE67602_Joost</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LoadData.html">LoadData</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">gf</span>, <span class="va">cf</span>, <span class="va">af</span><span class="op">)</span></pre></div>
<div id="remove-spike-in-rna" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-spike-in-rna" class="anchor"></a>Remove Spike-in RNA</h3>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">gene_names</span> <span class="op">&lt;-</span> <span class="va">GSE67602_Joost</span><span class="op">$</span><span class="va">gene_names</span>
<span class="va">spikein</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">'ERCC'</span>, <span class="va">gene_names</span><span class="op">)</span>
<span class="va">gene_names</span> <span class="op">&lt;-</span> <span class="va">gene_names</span><span class="op">[</span><span class="op">-</span><span class="va">spikein</span><span class="op">]</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">GSE67602_Joost</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">spikein</span>,<span class="op">]</span></pre></div>
<p>Apply number of features and exclusion threshold</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">logdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">data</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">gene_expression_threshold</span> <span class="op">&lt;-</span> <span class="fl">0.03</span>
<span class="va">n_features</span> <span class="op">&lt;-</span> <span class="fl">3000</span>
<span class="va">filtered_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SelectData.html">SelectData</a></span><span class="op">(</span><span class="va">logdata</span>, <span class="va">gene_expression_threshold</span>, <span class="va">n_features</span><span class="op">)</span></pre></div>
</div>
</div>
<div id="compute-the-similarity-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-the-similarity-matrix" class="anchor"></a>Compute the Similarity Matrix</h2>
<p>Run L2R2 on the processed data, outputting the number of iterations and value of the objective.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SimilarityM.html">SimilarityM</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.05</span>, 
                 data <span class="op">=</span> <span class="va">filtered_data</span><span class="op">$</span><span class="va">M_variable</span>,
                 dims <span class="op">=</span> <span class="fl">3</span>,
                 pre_embed_method <span class="op">=</span> <span class="st">'tsne'</span>,
                 perplexity <span class="op">=</span> <span class="fl">20</span>, 
                 pca_center <span class="op">=</span> <span class="cn">TRUE</span>, 
                 pca_scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p>Compute distances on the similarity matrix. If the truncated graph has multiple components, join them to allow inter-cluster distance estimation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">low_dim_mapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RepresentationMap.html">RepresentationMap</a></span><span class="op">(</span>similarity_matrix <span class="op">=</span> <span class="va">S</span><span class="op">$</span><span class="va">W</span>,
                                      flat_embedding_method <span class="op">=</span> <span class="st">'tsne'</span>,
                                      join_components <span class="op">=</span> <span class="cn">TRUE</span>,
                                      perplexity <span class="op">=</span> <span class="fl">35</span>,
                                      theta <span class="op">=</span> <span class="fl">0.5</span>,
                                      normalize <span class="op">=</span> <span class="cn">FALSE</span>,
                                      pca <span class="op">=</span> <span class="cn">TRUE</span>,
                                      pca_center <span class="op">=</span> <span class="cn">TRUE</span>,
                                      pca_scale <span class="op">=</span> <span class="cn">TRUE</span>,
                                      dims <span class="op">=</span> <span class="fl">2</span>,
                                      initial_dims <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></pre></div>
</div>
<div id="cluster-the-cells" class="section level2">
<h2 class="hasAnchor">
<a href="#cluster-the-cells" class="anchor"></a>Cluster the Cells</h2>
<p>Cluster the cells by factoring the similarity matrix. Infer cluster number using spectra of the ensemble Laplacian. In this analysis, we obtain bounds on the number of clusters, where the lower bound is equal to the number of zero eigenvalues and the upper bound is the index of the eigenvalue preceding the largest eigengap. We take this value as the cluster number.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ClusterCells.html">ClusterCells</a></span><span class="op">(</span>similarityMatrix <span class="op">=</span> <span class="va">S</span><span class="op">$</span><span class="va">W</span>, n_comp <span class="op">=</span> <span class="fl">15</span>, .options<span class="op">=</span><span class="st">'p'</span><span class="op">)</span>
<span class="va">H</span> <span class="op">&lt;-</span> <span class="va">clusters</span><span class="op">$</span><span class="va">H</span>
<span class="va">labels</span> <span class="op">&lt;-</span> <span class="va">clusters</span><span class="op">$</span><span class="va">labels</span>
<span class="va">n_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">labels</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, 
     <span class="va">clusters</span><span class="op">$</span><span class="va">ensemble</span><span class="op">$</span><span class="va">eigs</span><span class="op">$</span><span class="va">val</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,
     xlab <span class="op">=</span> <span class="cn">NA</span>,
     ylab <span class="op">=</span> <span class="st">'eigenvalues'</span>,
     main <span class="op">=</span> <span class="st">'Eigenvalues of the Graph Laplacian'</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div id="visualize-the-clusters" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-the-clusters" class="anchor"></a>Visualize the Clusters</h3>
<p>Cells are labeled by cluster membership and plotted on low-dimensional embedding (t-SNE) of the similarity matrix.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="co"># define a scheme for the coloring.  This is a required parameter for plotting discrete (factor) data</span>
<span class="va">colorscale</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ColorHue.html">ColorHue</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">colorscale</span> <span class="op">&lt;-</span> <span class="va">colorscale</span><span class="op">$</span><span class="va">hex.1.n.</span>

<span class="co"># plot clusters</span>
<span class="fu"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span><span class="op">(</span>flat_embedding <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">flat_embedding</span>,
                         feature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span>,
                         title <span class="op">=</span> <span class="st">"NMF Cluster Labeling"</span>,
                         subtitle <span class="op">=</span> <span class="st">"t-SNE Embedding"</span>,
                         featurename <span class="op">=</span> <span class="st">"Cluster ID"</span>,
                         colorscale <span class="op">=</span> <span class="va">colorscale</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>As described in Joost et al (2016), Subpopulations including Basal, IFE-DI, IFE-DII, IFE-KI, IFE-KII were identified by standard techniques.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">true_labels</span> <span class="op">&lt;-</span> <span class="va">GSE67602_Joost</span><span class="op">$</span><span class="va">annotation</span>
<span class="co"># plot clusters</span>
<span class="fu"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span><span class="op">(</span>flat_embedding <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">flat_embedding</span>,
                         feature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">true_labels</span><span class="op">)</span>,
                         title <span class="op">=</span> <span class="st">"True Labeling"</span>,
                         subtitle <span class="op">=</span> <span class="st">"t-SNE Embedding"</span>,
                         featurename <span class="op">=</span> <span class="st">"Annotated Cell Types"</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
<div id="find-cluster-marker-genes-" class="section level2">
<h2 class="hasAnchor">
<a href="#find-cluster-marker-genes-" class="anchor"></a>Find cluster marker genes.</h2>
<p>Previously, we clustered the cells using L2R2/Sym-NMF, now we analyze the markers of the clusters. We look at the normalized expression values of all genes using pre-selection parameters similar to the pre-clustering selection parameters. The top six markers selected as described in Wang et. al. As expected, markers Krt14, Krt10, and Lor are inferred for clusters overlapping with IHC-based Basal, Differentiated (IFE-DI, IFE-DII), and Keratinized (IFE-KI, IFE-KII) cell annotations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetMarkerTable.html">GetMarkerTable</a></span><span class="op">(</span>counts_data <span class="op">=</span> <span class="va">logdata</span>,
                            cluster_labels <span class="op">=</span> <span class="va">labels</span>,
                            H <span class="op">=</span> <span class="va">H</span>,
                            n_sorted <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>

<span class="fu"><a href="../reference/PlotTopN_Grid.html">PlotTopN_Grid</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">logdata</span>,
              cluster_labels <span class="op">=</span> <span class="va">labels</span>,
              markers <span class="op">=</span> <span class="va">markers</span><span class="op">$</span><span class="va">all</span>,
              n_features <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>
<span class="co">#&gt; Joining, by = "geneSymbol"</span>
<span class="co">#&gt; Joining, by = "fac_barcode"</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div id="pseudotime-inference" class="section level2">
<h2 class="hasAnchor">
<a href="#pseudotime-inference" class="anchor"></a>Pseudotime Inference</h2>
<p>Compute cluster-cluster graph and find the root cluster.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">cluster_ptime</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FindRootCluster.html">FindRootCluster</a></span><span class="op">(</span>cluster_labels <span class="op">=</span> <span class="va">labels</span>,
                                 flat_embedding <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">flat_embedding</span>,
                                 dist_graph <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">dist_graph</span>,
                                 dist_flat <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">dist_flat</span>,
                                 reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p>Compute the cell-cell graph and find the root cell.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">root_cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FindRootCell.html">FindRootCell</a></span><span class="op">(</span>use_flat_dist <span class="op">=</span> <span class="cn">FALSE</span>,
                          cluster_order_by <span class="op">=</span> <span class="st">"distance"</span>,
                          cell_order_by <span class="op">=</span> <span class="st">"distance"</span>,
                          graph_cluster_mst <span class="op">=</span> <span class="va">cluster_ptime</span><span class="op">$</span><span class="va">cluster_mst</span>,
                          dist_graph  <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">dist_graph</span>,
                          dist_flat <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">dist_flat</span>,
                          cluster_labels <span class="op">=</span> <span class="va">labels</span>,
                          root_cluster <span class="op">=</span> <span class="va">cluster_ptime</span><span class="op">$</span><span class="va">root_cluster</span><span class="op">)</span></pre></div>
</div>
<div id="pseudotime-visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#pseudotime-visualization" class="anchor"></a>Pseudotime Visualization</h2>
<p>Compute the directional minimum spanning tree on the cluster-cluster graph for visualization.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="va">cluster_predecessors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetPredecessors.html">GetPredecessors</a></span><span class="op">(</span><span class="va">cluster_ptime</span><span class="op">$</span><span class="va">cluster_mst</span>, <span class="va">cluster_ptime</span><span class="op">$</span><span class="va">root_cluster</span><span class="op">)</span>
<span class="va">cluster_dtree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetDominatorTree.html">GetDominatorTree</a></span><span class="op">(</span><span class="va">cluster_predecessors</span>, <span class="va">cluster_ptime</span><span class="op">$</span><span class="va">graph_cluster</span><span class="op">)</span>
<span class="fu"><a href="../reference/PlotLineage.html">PlotLineage</a></span><span class="op">(</span><span class="va">cluster_dtree</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Compute the path-length vector from root, and plot the cells in the previously computed low-dimensional embedding.</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="va">pseudotime</span> <span class="op">&lt;-</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">dist_graph</span><span class="op">[</span><span class="va">root_cell</span>,<span class="op">]</span>

<span class="co"># plot pseudotime</span>
<span class="fu"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span><span class="op">(</span>flat_embedding <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">flat_embedding</span>,
                         feature <span class="op">=</span> <span class="va">pseudotime</span>,
                         title <span class="op">=</span> <span class="st">"Pseudotime Labeling"</span>,
                         subtitle <span class="op">=</span> <span class="st">"t-SNE Embedding"</span>,
                         featurename <span class="op">=</span> <span class="st">"Pseudotime Distance"</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div id="plot-gene-expression-on-the-flat-embedding" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-gene-expression-on-the-flat-embedding" class="anchor"></a>Plot Gene Expression on the Flat Embedding</h2>
<p>Plot Expression of Krt14, Krt10, and Lor in t-SNE Space:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="va">gene_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gene_names</span> <span class="op">==</span> <span class="st">'Krt14'</span><span class="op">)</span>
<span class="va">data_gene</span> <span class="op">&lt;-</span> <span class="va">logdata</span><span class="op">[</span><span class="va">gene_index</span>,<span class="op">]</span>

<span class="co"># plot features</span>
<span class="fu"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span><span class="op">(</span>flat_embedding <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">flat_embedding</span>,
                    feature <span class="op">=</span> <span class="va">data_gene</span>,
                    title <span class="op">=</span> <span class="st">"Krt14 Expression"</span>,
                    subtitle <span class="op">=</span> <span class="st">"t-SNE Embedding"</span>,
                    featurename <span class="op">=</span> <span class="st">"Log Expression"</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="va">gene_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gene_names</span> <span class="op">==</span> <span class="st">'Krt10'</span><span class="op">)</span>
<span class="va">data_gene</span> <span class="op">&lt;-</span> <span class="va">logdata</span><span class="op">[</span><span class="va">gene_index</span>,<span class="op">]</span>

<span class="co"># plot features</span>
<span class="fu"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span><span class="op">(</span>flat_embedding <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">flat_embedding</span>,
                    feature <span class="op">=</span> <span class="va">data_gene</span>,
                    title <span class="op">=</span> <span class="st">"Krt10 Expression"</span>,
                    subtitle <span class="op">=</span> <span class="st">"t-SNE Embedding"</span>,
                    featurename <span class="op">=</span> <span class="st">"Log Expression"</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="va">gene_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gene_names</span> <span class="op">==</span> <span class="st">'Lor'</span><span class="op">)</span>
<span class="va">data_gene</span> <span class="op">&lt;-</span> <span class="va">logdata</span><span class="op">[</span><span class="va">gene_index</span>,<span class="op">]</span>

<span class="co"># plot features</span>
<span class="fu"><a href="../reference/FeatureScatterPlot.html">FeatureScatterPlot</a></span><span class="op">(</span>flat_embedding <span class="op">=</span> <span class="va">low_dim_mapping</span><span class="op">$</span><span class="va">flat_embedding</span>,
                    feature <span class="op">=</span> <span class="va">data_gene</span>,
                    title <span class="op">=</span> <span class="st">"Lor Expression"</span>,
                    subtitle <span class="op">=</span> <span class="st">"t-SNE Embedding"</span>,
                    featurename <span class="op">=</span> <span class="st">"Log Expression"</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div id="plot-gene-expression-levels-in-cells-grouped-by-cluster" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-gene-expression-levels-in-cells-grouped-by-cluster" class="anchor"></a>Plot Gene Expression Levels in Cells Grouped by Cluster</h2>
<p>Violin Plot of Krt14 expression. Note strong expression of the basal compartment:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
  <span class="fu"><a href="../reference/ViolinPlotExpression.html">ViolinPlotExpression</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">logdata</span>,
                       gene_names <span class="op">=</span> <span class="va">gene_names</span>,
                       labels <span class="op">=</span> <span class="va">labels</span>,
                       gene_name <span class="op">=</span> <span class="st">"Krt14"</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-18-1.png" width="700"> Violin Plot of Krt10 expression. Note uniformly high expression in the IFE-DI/DII compartments:</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
  <span class="fu"><a href="../reference/ViolinPlotExpression.html">ViolinPlotExpression</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">logdata</span>,
                       gene_names <span class="op">=</span> <span class="va">gene_names</span>,
                       labels <span class="op">=</span> <span class="va">labels</span>,
                       gene_name <span class="op">=</span> <span class="st">"Krt10"</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-19-1.png" width="700"> Violin Plot of Lor expression. Note strong expression in the terminally differentiated IFE-KI/KII compartments:</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
  <span class="fu"><a href="../reference/ViolinPlotExpression.html">ViolinPlotExpression</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">logdata</span>,
                       gene_names <span class="op">=</span> <span class="va">gene_names</span>,
                       labels <span class="op">=</span> <span class="va">labels</span>,
                       gene_name <span class="op">=</span> <span class="st">"Lor"</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div id="analyze-signaling-mediated-by-a-ligand-receptor-family" class="section level2">
<h2 class="hasAnchor">
<a href="#analyze-signaling-mediated-by-a-ligand-receptor-family" class="anchor"></a>Analyze Signaling Mediated by a Ligand-Receptor Family</h2>
<p>There are two tables needed to specify prior knowledge of the pathway:</p>
<ul>
<li><p>ligand-receptor interactions. link: <a href="https://github.com/mkarikom/RSoptSC/blob/master/inst/extdata/tgfb_lig_rec.tsv"><code>RSoptSC/inst/extdata/tgfb_lig_rec.tsv</code></a></p></li>
<li><p>receptor-target interactions. link: <a href="https://github.com/mkarikom/RSoptSC/blob/master/inst/extdata/tgfb_rec_target.tsv"><code>RSoptSC/inst/extdata/tgfb_rec_target.tsv</code></a></p></li>
</ul>
<p>SoptSC requires the paths of these two files to be passed to <code><a href="../reference/ImportPathway.html">ImportPathway()</a></code> as shown below:</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>

<span class="va">lig_rec_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tgfb_lig_rec.tsv"</span>, package <span class="op">=</span> <span class="st">"RSoptSC"</span><span class="op">)</span>
<span class="va">rec_target_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tgfb_rec_target_both.tsv"</span>, package <span class="op">=</span> <span class="st">"RSoptSC"</span><span class="op">)</span>
<span class="va">pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ImportPathway.html">ImportPathway</a></span><span class="op">(</span>lig_table_path <span class="op">=</span> <span class="va">lig_rec_path</span>,
                         rec_table_path <span class="op">=</span> <span class="va">rec_target_path</span>,
                         data <span class="op">=</span> <span class="va">logdata</span>,
                         gene_names <span class="op">=</span> <span class="va">gene_names</span><span class="op">)</span>



<span class="va">k</span> <span class="op">=</span> <span class="va">pathway</span><span class="op">$</span><span class="va">pathway</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p>Using the ImportPathway function, an inner join over the two tables tabulates all ligand/receptor/target/direction 4-tuples. We then compute the probability of intercellular interaction based on this pathway.</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>

<span class="va">lig_rec_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tgfb_lig_rec.tsv"</span>, package <span class="op">=</span> <span class="st">"RSoptSC"</span><span class="op">)</span>
<span class="va">rec_target_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tgfb_rec_target_both.tsv"</span>, package <span class="op">=</span> <span class="st">"RSoptSC"</span><span class="op">)</span>
<span class="va">pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ImportPathway.html">ImportPathway</a></span><span class="op">(</span>lig_table_path <span class="op">=</span> <span class="va">lig_rec_path</span>,
                         rec_table_path <span class="op">=</span> <span class="va">rec_target_path</span>,
                         data <span class="op">=</span> <span class="va">logdata</span>,
                         gene_names <span class="op">=</span> <span class="va">gene_names</span><span class="op">)</span>



<span class="va">k</span> <span class="op">=</span> <span class="va">pathway</span><span class="op">$</span><span class="va">pathway</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>kable_input <span class="op">=</span> <span class="va">k</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/scroll_box.html">scroll_box</a></span><span class="op">(</span>height <span class="op">=</span> <span class="st">"500px"</span>, width <span class="op">=</span> <span class="st">"300px"</span><span class="op">)</span></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:300px; ">
<table class="table table">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
receptor
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
ligand
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
target
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
direction
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Zeb2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Smad2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Wnt4
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Wnt11
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Bmp7
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Sox9
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Notch1
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Dnmt3b
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Dnmt1
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Zeb2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Smad2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Wnt4
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Wnt11
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Bmp7
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Sox9
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Notch1
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Dnmt3b
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr1
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Dnmt1
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Smad2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Wnt4
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Zeb2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Sox9
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Notch1
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Wnt11
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Bmp7
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Dnmt1
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb1
</td>
<td style="text-align:left;">
Dnmt3b
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Smad2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Wnt4
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Zeb2
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Sox9
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Notch1
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Wnt11
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Bmp7
</td>
<td style="text-align:left;">
up
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Dnmt1
</td>
<td style="text-align:left;">
down
</td>
</tr>
<tr>
<td style="text-align:left;">
Tgfbr2
</td>
<td style="text-align:left;">
Tgfb2
</td>
<td style="text-align:left;">
Dnmt3b
</td>
<td style="text-align:left;">
down
</td>
</tr>
</tbody>
</table>
</div>
<div id="plot-of-intercellular-network" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-of-intercellular-network" class="anchor"></a>Plot of Intercellular Network</h3>
<p>Now plot the previous result as a circos plot on the top five ligand-producing and top five receptor-bearing cells from every cluster. The upper hemisphere of the plot shows receptor-bearing cells. The chords of the plot are colored by the ligand-producing cells in the lower hemisphere.</p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="fu"><a href="../reference/SigPlot.html">SigPlot</a></span><span class="op">(</span><span class="va">Pmats</span><span class="op">$</span><span class="va">P_tot</span>,<span class="va">labels</span><span class="op">)</span>
<span class="co">#&gt; Joining, by = "Var2"</span>
<span class="co">#&gt; Joining, by = "Var1"</span>
<span class="co">#&gt; Joining, by = "Var1"</span>
<span class="co">#&gt; Joining, by = "Var2"</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
<div id="plot-of-intercluster-network" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-of-intercluster-network" class="anchor"></a>Plot of Intercluster Network</h3>
<p>Directional plot of cluster-to-cluster signaling. The root of the directional chord is raised.</p>
<div class="sourceCode" id="cb24"><pre class="downlit">
  <span class="va">cluster_P</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ClusterSig.html">ClusterSig</a></span><span class="op">(</span><span class="va">Pmats</span>,
                          cluster_labels <span class="op">=</span> <span class="va">labels</span><span class="op">)</span>
<span class="co">#&gt; Joining, by = c("cluster.Var1", "cluster.Var2")</span>
<span class="co">#&gt; Joining, by = c("cluster.Var1", "cluster.Var2")</span>
<span class="co">#&gt; Joining, by = c("cluster.Var1", "cluster.Var2")</span>
  <span class="fu"><a href="../reference/SigPlot_Cluster.html">SigPlot_Cluster</a></span><span class="op">(</span><span class="va">cluster_P</span><span class="op">$</span><span class="va">P_tot</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_clusters</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
<div id="heatmap-of-signaling-marker-expression" class="section level3">
<h3 class="hasAnchor">
<a href="#heatmap-of-signaling-marker-expression" class="anchor"></a>Heatmap of Signaling Marker Expression</h3>
<p>Visualize the expression of ligand/receptor and up/down target expression across clusters</p>
<div class="sourceCode" id="cb25"><pre class="downlit">
  <span class="va">gene_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Tgfb1'</span>, <span class="st">'Tgfb2'</span>, 
                <span class="st">'Tgfbr1'</span>, <span class="st">'Tgfbr2'</span>,
                <span class="st">'Zeb2'</span>,<span class="st">'Smad2'</span>,<span class="st">'Wnt4'</span>,<span class="st">'Wnt11'</span>,<span class="st">'Bmp7'</span>,<span class="st">'Sox9'</span>,<span class="st">'Notch1'</span><span class="op">)</span>

  <span class="fu"><a href="../reference/PlotClusterExpression.html">PlotClusterExpression</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">logdata</span>,
                        cluster_labels <span class="op">=</span> <span class="va">labels</span>, 
                        markers <span class="op">=</span> <span class="va">gene_list</span><span class="op">)</span></pre></div>
<p><img src="RSoptSC_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matt Karikomi, Shuxiong Wang, Adam MacLean.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
